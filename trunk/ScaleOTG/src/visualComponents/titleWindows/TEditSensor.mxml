<?xml version="1.0" encoding="utf-8"?>
<mx:TitleWindow xmlns:vld="lib.validator.*" xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute" title="传感器详情" showCloseButton="true" close="closeWindow();" 
	 creationComplete="centerWindow();init();" width="620" height="366">
	<mx:Script>
		<![CDATA[
			import lib.command.ShowEditSensorDataType;
		import lib.events.HSListEvent;
		import lib.communicator.download.Sensor_SensorDataType;
		import mx.managers.PopUpManager;
		import lib.communicator.operation.EditSensor;
		import lib.events.ItemRendererEvent;
		import lib.command.Appcmd;
		private var sid:uint;
		private var ssd:Sensor_SensorDataType;
		public function set sensorID(value:uint):void
		{
			this.sid=value;
			this.ipt_sensorID.text=value.toString();
			ssd=Sensor_SensorDataType.getInstance();
			ssd.sensorID=value;
			ssd.addEventListener(HSListEvent.LIST_SUCCESS,onDataTypeLoaded);
			ssd.sendHS();
		}
		public function centerWindow():void
        {
        	PopUpManager.centerPopUp(this);
        }
        
        public function closeWindow():void
        {
        	PopUpManager.removePopUp(this);
        }
        
        private function init():void
        {
        	dataTypeList.addEventListener(ItemRendererEvent.SHOW_DETAIL,showDataTypeDetail);
        }
        private function showDataTypeDetail(e:ItemRendererEvent):void
        {
        	var invoker:Appcmd=Appcmd.getInstance();
        	invoker.showEditSensorDataType=new ShowEditSensorDataType(e.contentID);
        	invoker.showEditSensorDataType.execute();
        }
        private function onDataTypeLoaded(e:Event=null):void
        {
        	dataTypeList.dataProvider=ssd.recordList;
        }
        private function onEdit(e:Event=null):void
        {
        	var es:EditSensor=new EditSensor();
        	es.sensorID=Number(ipt_sensorID.text);
        	es.sensorName=ipt_sensorName.text;
        	es.location=ipt_location.text;
        	es.manufacture=ipt_manufacture.text;
        	es.description=ipt_description.text;
        	es.memo=ipt_memo.text;
        	es.addEventListener(HSListEvent.OPERATION_SUCCESS,onEditSuccess);
        	es.sendHS();
        }
        private function onEditSuccess(e:Event=null):void
        {
        	closeWindow();	
        }
		]]>
	</mx:Script>
	<mx:HBox y="10" left="10" right="10">
		<mx:Form width="280">
			<mx:FormItem label="传感器编号">
				<mx:TextInput enabled="false" id="ipt_sensorID"/>
			</mx:FormItem>
			<mx:FormItem label="传感器名称">
				<mx:TextInput id="ipt_sensorName" enabled="false"/>
			</mx:FormItem>
			<mx:FormItem label="位置">
				<mx:TextInput id="ipt_location"/>
			</mx:FormItem>
		</mx:Form>
		<mx:Form width="100%" height="100%">
			<mx:FormItem label="生产厂家">
				<mx:TextInput id="ipt_manufacture" enabled="false"/>
			</mx:FormItem>
			<mx:FormItem label="描述">
				<mx:TextInput id="ipt_description" enabled="false"/>
			</mx:FormItem>
			<mx:FormItem label="备注">
				<mx:TextInput id="ipt_memo"/>
			</mx:FormItem>
		</mx:Form>
	</mx:HBox>
	<mx:DataGrid width="486" height="176" y="137" x="10" id="dataTypeList">
		<mx:columns>
			<mx:DataGridColumn headerText="名称" dataField="@typeName"/>
			<mx:DataGridColumn headerText="单位" dataField="@unit"/>
			<mx:DataGridColumn headerText="操作" itemRenderer="visualComponents.itemRenderers.DataTypeOperations"/>
		</mx:columns>
	</mx:DataGrid>
	<mx:Button x="504" y="231" label="确定" click="onEdit();" icon="@Embed(source='../../img/yes.png')"/>
	<mx:Button x="504" y="276" label="取消" click="closeWindow();" icon="@Embed(source='../../img/no.png')"/>
</mx:TitleWindow>
